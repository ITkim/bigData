/* 
1. 문제풀이
2. 문제 자체의 문제점도 찾아보기
3. 마지막에 개인문제 5개 포함
	- 제시자 : 박진영
	- 응시자 : 서영상, 허윤길
	- 응시자 : 문제 풀고, 친구 문제에 대한 comment(진솔하게!)
	- 제출 포맷 : 제시자-누구, 응시자-누구.sql.txt
*/
/**1.
부서번호가 10번인 부서의 사람 중 사원번호, 이름, 월급을 출력하라
*/

SELECT empno AS 사원번호, ename AS 이름, sal AS 월급 FROM emp WHERE deptno=10;

/**2.
사원번호가 7369인 사람 중 이름, 입사일, 부서 번호를 출력하라.
*/

SELECT ename AS 이름, hiredate AS 입사일, deptno AS 부서번호 FROM emp WHERE empno=7369;

/**3.
이름이 ALLEN인 사람의 모든 정보를 출력하라.
*/

 SELECT * FROM emp WHERE ename = 'ALLEN';

/**4.
입사일이 83/01//12인 사원의 이름, 부서번호, 월급을 출력하라.
*/

SELECT ename AS 이름, deptno AS 부서번호, sal AS 월급 FROM emp WHERE hiredate LIKE '83/01/12';

/**5.
직업이 MANAGER가 아닌 사람의 모든 정보를 출력하라.
*/

SELECT * FROM emp WHERE job != 'MANAGER';

/**6.
입사일이 81/04/02 이후에 입사한 사원의 정보를 출력하라.
*/

SELECT * FROM emp WHERE hiredate > '81/04/02';


/**7.
급여가 800이상인 사람의 이름, 급여, 부서번호를 출력하라
*/

SELECT ename AS 이름, sal AS 급여, deptno AS 부서번호 FROM emp WHERE sal >=800;

/**8.
부서번호가 20번 이상인 사원의 보든 정보를 출력하라.
*/

SELECT * FROM emp WHERE deptno >=20;

/**9.
이름이 K로 시작하는 사람의 모든정보를 출력하라.
*/

SELECT * FROM emp WHERE ename LIKE 'K%';


/**10.
입사일이 81/12/09 보다 먼저 입사한 사람들의 모든 정보를 출력하라.
*/

SELECT * FROM emp WHERE hiredate < '81/12/09';


/**11.
입사번호가 7698보다 작거나 같은 사람들의 입사번호와 이름을 출력하라.
*/

SELECT empno AS 입사번호, ename AS 이름 FROM emp WHERE empno <= 7698;


/**12.
입사일이 81/04/02보다 늦고  82/12/09보다 빠른 사원의 이름, 월급, 부서번호를 출력하라.
*/

SELECT ename AS 이름, sal AS 월급, deptno AS 부서번호 FROM emp WHERE hiredate > '81/04/02' and hiredate < '82/12/09';


/**13.
급여가 1600보다 크고[초과] 3000보다 작은[미만] 사람의 이름, 직업, 급여를 출력하라.
*/


SELECT ename AS 이름, job AS 직업, sal AS 급여 FROM emp WHERE sal >1600 and sal <3000;

/**14.
사원번호가 7654와 7782사이 이외의 사원의 모든 정보를 출력하라.
*/

SELECT * FROM emp WHERE empno between 7654 and 7782;

/**15.
직업이 MANAGER와 SALESMAN인 사람의 모든 정보를 출력하라
*/

SELECT * FROM emp WHERE job = 'MANAGER' or job = 'SALESMAN';


/**16.
부서번호와 20,30번을 제외한 모든 사람의 이름, 사원번호, 부서번호를 출력하라.
*/

SELECT ename AS 이름, empno AS 사원번호, deptno AS 부서번호 FROM emp WHERE deptno !=20 and deptno !=30;


/**17.
이름이 S로 시작하는 사원의 사원번호, 이름, 입사일, 부서번호를 출력하라.
*/

SELECT empno AS 사원번호, ename AS 이름, hiredate AS 입사일, deptno AS 부서번호 FROM emp WHERE ename LIKE 'S%';


/**18.
이름중 S자가 들어가 있는 사람만 모든 정보를 출력하라.
*/

 SELECT * FROM emp WHERE ename LIKE '%S%';

/**19.
이름이 S로 시작하고 마지막 글자가 T인 사람이 정보를 출력하라. 단 이름은 전체 5자리이다.
*/

SELECT * FROM emp WHERE ename LIKE 'S___T';


/**20.
커미션이 null인 사원의 정보를 출력하라.
*/

SELECT * FROM emp WHERE comm IS null;


/**21.
커미션이 null이 아닌 사원의 정보를 출력하라.
*/


SELECT * FROM emp WHERE comm IS not null;

/**22.
부서가 30번 부서이고 급여가 1500이상인 사람의 이름, 부서, 월급(sal)을 출력하라.
*/

--JOIN을 배우지 않았기 때문에 deptno를 출력하겠습니다.
SELECT ename AS 이름, deptno AS 부서번호, sal AS 월급 FROM emp WHERE deptno=30 and sal>=1500;


/**22.
이름의 첫글자가 K로 시작하거나 부서번호가 30인 사람의 사원번호, 이름, 부서번호를 출력하라.
*/


SELECT empno AS 사원번호, ename AS 이름, deptno AS 부서번호 FROM emp WHERE ename LIKE 'K%' or deptno =30;

/**23.
급여가 1500이상이고 부서번호가 30번인 사원중 직업이 MANAGER인 사람의 정보를 출력하라.

SELECT * FROM emp WHERE sal >=1500 and deptno=30 and job = 'MANAGER';

/**24.
부서번호가 30인 사람중 사원번호 정렬하라.
*/

--오름차순 정렬
SELECT empno AS 사원번호 FROM emp WHERE deptno=30 ORDER BY empno asc;
--내림차순 정렬
SELECT empno AS 사원번호 FROM emp WHERE deptno=30 ORDER BY empno desc;

/**25.
급여가 많은 순으로 정렬하라.
*/

 SELECT * FROM emp ORDER BY sal desc;

/**26.
부서번호로 오름차순 한 후 급여가 많은 사람 순으로 출력하라.
*/

SELECT * FROM emp ORDER BY deptno asc, sal desc;

/**27.
부서번호로 내림차순 하고 급여순으로 내림차순하라.
*/

SELECT * FROM emp ORDER BY deptno desc, sal desc;


---------------------------개인문제

/**1.
연봉이 16000 이상인 사람들의 이름, 직업, 연봉+성과금을 직업의 오름차순에 따라 출력하라.
-- (단, 이름 = 사원명, 직업 = 직업, 연봉+성과금 = 전체연봉 으로 출력)
-- Hint : 1) 연봉 = sal*12, 2)전체 연봉 = 연봉+성과금


/**2.
부서번호가 10이 아닌 사람들 중 81년에 입사한 사람들의 모든 정보를 입사일의 오름차순에 따라 출력하라.




/**3.
81년에 입사한 사람들 중 이름에 D가 들어가는 사원들의 이름과 직업을 출력하라.




/**4.
모든 사원에 대해 입사일을 오름차순으로 정렬하고 직업에 대해 내림차순으로 모든 정보를 출력하라.




/**5.
사원번호가 7500이상인 사람들 중 월급이 1500 이하인 사람들의 이름, 사원번호, 월급, 입사일을 출력하라.
-- (단, 사원명, 사원번호, 월급, 입사일로 이름을 출력하라)


-----------------------------답
/**1.

SELECT ename AS 사원명, job AS 직업, ((sal*12)+nvl(comm,0)) AS 전체연봉 FROM emp WHERE (sal*12)>= 16000 ORDER BY job asc;


/**2.

SELECT * FROM emp WHERE deptno !=10 and hiredate LIKE '81/%' ORDER BY hiredate asc;

/**3.

SELECT ename AS 사원명, job AS 직업 FROM emp WHERE ename LIKE '%D%';

/**4.

SELECT * FROM emp ORDER BY hiredate asc, job desc;

/**5.

SELECT ename AS 사원명, empno AS 사원번호, sal AS 월급, hiredate AS 입사일 FROM emp WHERE empno >=7500 and sal <=1500;

------------------------------윤길 문제

1. 연봉이 10,000이 넘는 사람을 구하라. 

SELECT ename AS name, (sal*12) AS 연봉 FROM emp WHERE (sal*12) >=10000;

2. 고용한 사람 중 가장 돈을 많이 버는 의 직업은 누구인가

SELECT ename AS 이름 FROM emp Order BY (sal*12) desc;
=> KING

3. 가장 작은 돈을 버는 직업은 누구인가

SELECT ename AS 이름 FROM emp ORDER BY (sal*12) asc;
=> SMITH

4. 입사한 후 30년뒤에 나가야된다면 누가 처음으로 나갈것인가
SELECT * FROM emp ORDER BY hiredate desc;
=> MILLER

5. SMITH의 직장 동료는 누구인가.
SELECT * FROM emp WHERE job = 'CLERK' and ename != 'SMITH';
JAMES, MILLER				-- 직업명 CLERK인 동료

SELECT * FROM emp WHERE deptno =20 and ename != 'SMITH';
					-- 부서번호 20인 동료
	
------- Comment => 문제 자체의 해석을 요하는 문제가 많았고, 아직 배우지 않은 함수를 요구하는 것 같아서
		   생각을 많이하게 했습니다. 아직 배우지 않은 부분은 배운 것을 최대한 활용하여 도출했습니다.


------------------------------영상 문제

1. 월급이 2000 이상 5000이하가 아닌 사람의 이름과 월급 출력하라.
SELECT ename AS 사원명, sal AS 월급 FROM emp WHERE not sal >= 2000 or not sal <=5000;
SELECT * FROM emp WHERE sal NOT BETWEEN 2000 AND 5000;

2. 직업이 CLERK이며 첫자에 M이 들어가지 않는 사원번호와 이름, 입사일을 출력하라.

SELECT empno, ename, hiredate FROM emp WHERE job = 'CLERK' AND ename NOT LIKE 'M%';

3. comm이 가장 높은 순서대로 정렬하되 사원번호, 이름, comm을 출력하라.

SELECT empno AS 사원번호, ename AS 이름, nvl(comm,0) AS 성과금 FROM emp ORDER BY comm desc;
-- => null의 경우에 먼저 처리해서 가장 위부터 정렬하는 것 같음

4. comm을 받는 사람들의 이름, 직업, 연봉(연봉 이름 지정할것)을 출력하라.
SELECT ename, job, (sal*12) AS 연봉 FROM emp WHERE comm IS NOT NULL;

5. 부서번호가 30이며 연봉(연봉 이름 지정할 것)이 15000이상 20000 이하
 SELECT ename AS 사원명, (sal*12) AS 연금 FROM emp WHERE deptno =30 AND (sal*12) BETWEEN 15000 AND 20000;


-------- Comment => 오늘 배운 함수에 대해 적용할 수 있는지에 대한 문제여서 재적립 하는데 좋았습니다.
		    3번 문제 이외의 경우는 좋은 문제라고 생각합니다.